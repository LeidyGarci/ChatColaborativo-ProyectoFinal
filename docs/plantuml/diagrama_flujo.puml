@startuml
actor Usuario

participant GUI as "ChatApp_GUI"
participant Backend as "BackendCliente"
participant Servidor as "ServidorChat"

== Inicio de sesión ==
Usuario -> GUI: Ingresa nombre
GUI -> Backend: conectar(nombre)
Backend -> Servidor: HELLO#nombre
Servidor -> Backend: OK#Conexión establecida
Backend -> GUI: OK#Conexión establecida
GUI -> GUI: Mostrar MainMenuFrame

== Unión a sala ==
Usuario -> GUI: Selecciona sala o crea nueva
GUI -> Backend: JOIN_SALA#nombre_sala
Backend -> Servidor: JOIN_SALA#nombre_sala
Servidor -> Servidor: Registrar usuario en sala
Servidor -> Backend: OK#Te has unido a la sala 'SalaX'
Servidor -> Backend: CHAT#Usuario1: mensaje_prev
Backend -> GUI: OK#Te has unido a la sala 'SalaX'
Backend -> GUI: CHAT#Usuario1: mensaje_prev
GUI -> GUI: Mostrar ChatFrame y mensajes previos

== Envío de mensaje ==
Usuario -> GUI: Escribe mensaje
GUI -> Backend: MSG#texto
Backend -> Servidor: MSG#texto
Servidor -> Servidor: Guardar en historial
Servidor -> Backend: CHAT#Usuario: texto
Backend -> GUI: CHAT#Usuario: texto
GUI -> GUI: Mostrar mensaje en ventana de chat

== Salida de sala ==
Usuario -> GUI: Presiona "Salir de sala"
GUI -> Backend: LEAVE_SALA#nombre_sala
Backend -> Servidor: LEAVE_SALA#nombre_sala
Servidor -> Backend: OK#Has salido de la sala 'SalaX'
Servidor -> Backend: NOTIFY#Usuario ha salido
Backend -> GUI: INFO#Has salido de la sala 'SalaX'
Backend -> GUI: CHAT#Usuario ha salido
GUI -> GUI: Volver al MainMenuFrame

== Desconexión ==
Usuario -> GUI: Presiona "Cerrar sesión"
GUI -> Backend: SALIR#
Backend -> Servidor: SALIR#
Servidor -> Backend: DISCONNECTED#Conexión cerrada
Backend -> GUI: DISCONNECTED#Conexión cerrada
GUI -> GUI: Volver al LoginFrame

@enduml